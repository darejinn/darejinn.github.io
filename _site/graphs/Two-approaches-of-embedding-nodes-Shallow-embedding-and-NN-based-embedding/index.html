<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Two approaches of embedding nodes - DaRe_jin’s Blog</title>
<meta name="description" content="  ">


  <meta name="author" content="DaRe_jin">


<meta property="og:type" content="article">
<meta property="og:locale" content="ko">
<meta property="og:site_name" content="DaRe_jin's Blog">
<meta property="og:title" content="Two approaches of embedding nodes">
<meta property="og:url" content="http://localhost:4000/graphs/Two-approaches-of-embedding-nodes-Shallow-embedding-and-NN-based-embedding/">


  <meta property="og:description" content="  ">







  <meta property="article:published_time" content="2025-08-11T00:00:00+09:00">



  <meta property="article:modified_time" content="2025-08-11T00:00:00+09:00">



  

  


<link rel="canonical" href="http://localhost:4000/graphs/Two-approaches-of-embedding-nodes-Shallow-embedding-and-NN-based-embedding/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "DaRe_jin",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="google6dd9f38f264894e0.html" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="DaRe_jin's Blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


<script type="text/javascript"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
    <!-- start custom head snippets -->
<script data-ad-client="ca-pub-3886880548487088" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->


<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/logo.ico/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/logo.ico/favicon-96x96.png">
<link rel="mask-icon" href="/assets/logo.ico/favicon.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          DaRe_jin's Blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About Me</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#graphs" itemprop="item"><span itemprop="name">Graphs</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Two approaches of embedding nodes</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://github.com/user-attachments/assets/b9d11a7a-8e27-4c9d-959b-a200897167d6" alt="DaRe_jin" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">DaRe_jin</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>내실 있는 낙관</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      

      
        
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/darejinn" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">토글 메뉴</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">AI</span>
        

        
        <ul>
          
            <li><a href="/categories/Papers/">Papers</a></li>
          
            <li><a href="/categories/Graphs/">Graphs</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Medical</span>
        

        
        <ul>
          
            <li><a href="/categories/Projects/">Projects</a></li>
          
            <li><a href="/categories/Bioinformatics/">Bioinformatics</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Diary</span>
        

        
        <ul>
          
            <li><a href="/categories/Thoughts/">Thoughts</a></li>
          
            <li><a href="/categories/Finance/">Finance</a></li>
          
            <li><a href="/categories/Bridges/">Bridges</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Two approaches of embedding nodes">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2025-08-11T00:00:00+09:00">
    <meta itemprop="dateModified" content="2025-08-11T00:00:00+09:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Two approaches of embedding nodes
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a>
    <ul>
      <li><a href="#review--learning-framework">Review : Learning framework</a></li>
    </ul>
  </li>
  <li><a href="#two-approaches-of-embedding-nodes">Two approaches of embedding nodes</a>
    <ul>
      <li><a href="#1-shallow-embedding">1. Shallow embedding</a>
        <ul>
          <li><a href="#1-1-factorization-based-approaches">1-1. Factorization-based approaches</a></li>
          <li><a href="#1-2-random-walk-based-approaches">1-2. Random walk-based approaches</a></li>
        </ul>
      </li>
      <li><a href="#2-nn-based-embedding">2. NN-based embedding</a>
        <ul>
          <li><a href="#2-1-neighborhood-autoencoder-dngr-sdne">2-1. Neighborhood Autoencoder (DNGR, SDNE)</a></li>
          <li><a href="#2-2-neighborhood-aggregation-gcngraphsagegat">2-2. Neighborhood Aggregation (GCN/GraphSAGE/GAT)</a></li>
        </ul>
      </li>
      <li><a href="#마무리하며">마무리하며</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <hr />

<h1 id="introduction">Introduction</h1>

<p>앞선 글에서 설명했듯, Graph Representation <strong>Learning</strong>은 그래프의 요소(노드, 엣지, 서브그래프)를 저차원 벡터로 매핑하는 일이다. 많은 survey가 여러 요소 중에서도 <strong>node embedding</strong>에 초점을 맞추는 이유는 다음과 같다.</p>

<ol>
  <li>
    <p><strong>Edge/Subgraph 임베딩이 node 임베딩의 후처리로 귀결</strong>되는 경우가 많다.</p>

    <p>예를 들어</p>
    <ul>
      <li>엣지 $(v_i,v_j)\in E$에 대해 노드 임베딩 $\mathbf{z}_i,\mathbf{z}_j$가 주어지면 hadamard/mean/weighted-L1·L2 같은 이항 연산으로</li>
    </ul>

\[\mathbf{z}_{(i,j)}=\mathbf{z}_i\odot\mathbf{z}_j\]

    <p>처럼 엣지 임베딩을 만든다.</p>

    <ul>
      <li>서브그래프 $\mathcal{G}[\mathcal{S}]$의 임베딩도 보통 $\mathcal{S}\subset\mathcal{V}$에 포함된 노드 임베딩을 집계(average/attention 등)해서 얻는다.</li>
    </ul>

\[\mathbf{z}_{\text{subgraph}}=\frac{1}{|\mathcal{S}|}\sum_{v_i\in\mathcal{S}}\mathbf{z}_i\]
  </li>
  <li>
    <p>Edge/Subgraph 임베딩을 <strong>직접</strong> 학습하더라도 절차는 <strong>node 임베딩 학습과 본질적으로 유사</strong>하다.</p>
    <ul>
      <li>예를 들어 타깃 서브그래프의 모든 노드에 연결된 dummy 노드를 추가하고 그 노드의 임베딩을 학습 대상으로 두면 사실상 node embedding 학습과 거의 동일한 형태가 된다.</li>
    </ul>
  </li>
</ol>

<p>따라서 node embedding을 이해하면 edge/subgraph embedding도 같은 틀 안에서 상당 부분 설명된다. 이하에서는 <strong>인코더를 어떻게 정의하는지</strong>에 따라 node embedding을 <strong>shallow embedding</strong>과 <strong>NN-based embedding</strong>으로 비교해 정리한다. 본 글의 뼈대는 Jure Leskovec 외, <em>Representation Learning on Graphs</em> (2017)을 바탕으로 필자의 해석을 더해 재구성했다.</p>

<hr />

<h2 id="review--learning-framework">Review : Learning framework</h2>

<p>“그래프에서 가까운 노드는 임베딩 공간에서도 가깝다”는 <strong>structural assumption</strong>(구조 가정) 아래, 다음 세 가지를 설계한다.</p>

<ul>
  <li>
    <p>그래프 상의 유사도 $s_G$</p>

\[s_G:\mathcal{V}\times\mathcal{V}\to\mathbb{R}^+,\qquad
s_G(i,j)\in\{A_{ij},\ k\text{-hop},\ \text{랜덤워크 공출현확률},\ \text{Katz/RPR/Jaccard}\dots\}\]
  </li>
  <li>
    <p>임베딩 공간의 디코더 $\mathrm{DEC}$</p>

\[\mathrm{DEC}:\mathbb{R}^d\times\mathbb{R}^d\to\mathbb{R},\quad
\text{예: }\ \mathbf{z}_i^\top\mathbf{z}_j,\ -\lVert\mathbf{z}_i-\mathbf{z}_j\rVert_2^2,\ \sigma(\mathbf{z}_i^\top\mathbf{z}_j)\]
  </li>
  <li>
    <p>인코더 $\mathrm{ENC}$와 loss function(learning objective)</p>

\[\mathbf{z}_i=\mathrm{ENC}(v_i),\qquad
\mathcal{L}=\sum_{(i,j)\in\mathcal{D}}\ell\!\Big(\mathrm{DEC}(\mathbf{z}_i,\mathbf{z}_j),\ s_G(i,j)\Big)\]
  </li>
</ul>

<p>여기서 <strong>구조 가정</strong>은 “무엇을 가깝게 유지할지”에 대한 inductive bias, 즉 <strong>네트워크 구조에 관한 모델의 prior</strong>다. $s_G$를 어떻게 정의할지(무엇을 ‘유사’로 볼지), $\mathrm{DEC}$를 어떻게 둘지(임베딩에서 유사를 어떻게 수치화할지), $\mathrm{ENC}$를 어떻게 설계할지(그 유사를 재현하도록 표현을 만들지)에 이 가정이 명시적·암묵적으로 들어 있다.</p>

<hr />

<h1 id="two-approaches-of-embedding-nodes">Two approaches of embedding nodes</h1>

<p>같은 $\mathrm{ENC}$–$s_G$–$\mathrm{DEC}$ 프레임 안에서 접근을 나눌 수 있다.</p>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>Shallow</strong> : 미리 정한 $s_G$에 맞춰 <strong>노드별 임베딩 자체</strong>를 <strong>직접</strong> 최적화한다. 따라서 파라미터 수는 대략 $ O(</td>
          <td>V</td>
          <td>d)$이다.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><strong>NN(GNN)-based</strong>: <strong>유사도를 만들어내는 연산 자체</strong>(메시지 패싱/오토인코더 등)를 학습해 임베딩을 <strong>간접</strong>적으로 만든다. 파라미터는 <strong>노드 간 공유</strong>된다.</li>
</ul>

<p>즉, <strong>학습이 일어나는 층위</strong>가 다르다.</p>

<hr />

<h2 id="1-shallow-embedding">1. Shallow embedding</h2>

<p>Shallow는 노드 ID를 임베딩 행렬의 열로 직접 매핑한다.</p>

\[Z\in\mathbb{R}^{d\times|\mathcal{V}|},\qquad \mathrm{ENC}(v_i)=Z_{\cdot i}=\mathbf{z}_i\]

<p>인코더가 단순하므로 “무엇을 보존할지”에 대한 선택이 거의 전적으로 $s_G$와 $\mathrm{DEC}$에 담긴다.</p>

<h3 id="1-1-factorization-based-approaches">1-1. Factorization-based approaches</h3>

<ul>
  <li>
    <p><strong>무엇을 보존할지($s_G$ 설정)</strong></p>

\[S=A\ \text{(adjacency)},\qquad S=A^k\ (k\text{-hop}),\qquad S=\text{Katz},\ \text{RPR},\ \text{Jaccard}\ \text{등}\]

    <p>$S$가 커뮤니티·근접성·전파 도달성 등 어떤 관계를 대표하는지에 따라 임베딩이 강조하는 구조가 달라진다.</p>
  </li>
  <li>
    <p><strong>임베딩에서 어떻게 읽을지(Decoder)</strong></p>

\[\mathrm{DEC}(\mathbf{z}_i,\mathbf{z}_j)=\mathbf{z}_i^\top\mathbf{z}_j\quad \text{또는}\quad -\lVert\mathbf{z}_i-\mathbf{z}_j\rVert_2^2\]

    <p>내적 기반은 계산이 단순하고 행렬분해로 자연스럽게 연결된다.</p>
  </li>
  <li>
    <p><strong>loss function(learning objective)</strong></p>

\[\min_Z\ \lVert S-Z^\top Z\rVert_F^2\]

    <p><strong>Laplacian Eigenmaps</strong>는</p>

\[\sum_{i,j}W_{ij}\lVert\mathbf{z}_i-\mathbf{z}_j\rVert_2^2
=2\,\mathrm{tr}(ZLZ^\top)\]

    <p>을 최소화해 인접 노드가 가깝도록 한다(정규화/제약 포함). 이 목적은 “엣지가 강하면 임베딩 거리를 줄여라”라는 규칙을 직접적으로 구현한다.</p>
  </li>
</ul>

<h3 id="1-2-random-walk-based-approaches">1-2. Random walk-based approaches</h3>

<ul>
  <li>
    <p><strong>무엇을 보존할지($s_G$ 설정)</strong></p>

    <p>랜덤 워크로 생성한 시퀀스에서 <strong>공출현 강도/확률</strong>을 노드 유사도로 본다(윈도우 공존, PPMI 등). BFS/DFS 성향을 조절해 국소/원거리 문맥을 강조할 수 있다.</p>
  </li>
  <li>
    <p><strong>임베딩에서 어떻게 읽을지(Decoder)</strong></p>

\[\mathrm{DEC}(\mathbf{z}_i,\mathbf{z}_j)=\mathbf{z}_i^\top\mathbf{z}_j\]

    <p>로짓을 $\sigma(\cdot)$로 확률화해 “같이 등장할수록 내적이 커지게” 학습한다.</p>
  </li>
  <li>
    <p><strong>loss function(learning objective)</strong></p>

\[\max_Z\sum_{(i,j)\in\mathcal{D}}\log\sigma(\mathbf{z}_i^\top\mathbf{z}_j)
+\!\!\sum_{(i,j')\in\mathcal{D}^-}\!\!\log\sigma(-\mathbf{z}_i^\top\mathbf{z}_{j'})\]

    <p><strong>DeepWalk</strong>는 unbiased walk, <strong>node2vec</strong>은 하이퍼파라미터 $p,q$로 탐색 편향을 조절한다.</p>
  </li>
</ul>

<blockquote>
  <p>즉, Shallow는 $s_G$의 정의가 곧 <strong>보존하려는 구조의 선언</strong>이고, $\mathrm{DEC}$는 이를 근사하는 간단한 함수(대개 inner product)다.</p>
</blockquote>

<hr />

<h2 id="2-nn-based-embedding">2. NN-based embedding</h2>

<p>Shallow가 node-id만 입력으로 받아 바로 embedding을 lookup하는 것과 달리, NN-based는 <strong>노드 특징 $\mathbf{x}_i$와 이웃 $\mathcal{N}(i)$를 입력으로 받아 처리하는 네트워크</strong>를 학습한다.</p>

<p>파라미터가 <strong>노드 간 공유</strong>되어 효율성이 높아지며, 특히 neighborhood aggregation 방법은 node의 총 개수에 관계 없이, 주변 node의 정보를 단계적으로 가져와 학습하므로, 아예 새로운 그래프에 대해서도 학습한 모델을 적용할 수 있다. ( <em>inductive하다</em> )</p>

<h3 id="2-1-neighborhood-autoencoder-dngr-sdne">2-1. Neighborhood Autoencoder (DNGR, SDNE)</h3>

<table>
  <tbody>
    <tr>
      <td>노드 i마다, 노드의 이웃 분포를 나타내는 벡터 $\mathbf{s}_i\in\mathbb{R}^{</td>
      <td>\mathcal{V}</td>
      <td>}$를 만든 뒤 오토인코더로 복원한다.</td>
    </tr>
  </tbody>
</table>

<p>즉, learning objective는 아래와 같다.</p>

\[\min_{\theta,\phi}\ \sum_i \left\lVert\mathbf{s}_i - \mathrm{DEC}_\phi(\mathrm{ENC}_\theta(\mathbf{s}_i))\right\rVert_2^2\]

<p><strong>SDNE</strong>는 여기에 Laplacian 정규화 항을 더해 인접 근접성을 강화한다.</p>

\[\sum_{(i,j)}W_{ij}\lVert\mathbf{z}_i-\mathbf{z}_j\rVert_2^2\]

<ul>
  <li>
    <p>$\mathbf{s}_i$를 <strong>어떻게 만들었는지</strong>가 곧 구조 가정이며, SDNE의 Lap 항은 구조 가정을 loss에서 명시적으로 추가한다.</p>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Shallow와 달리 <strong>파라미터가 공유</strong>되나 여전히 입력 차원이</td>
          <td>V</td>
          <td>에 고정되어 매우 큰 그래프에 적용하기 어렵고, 새로운 그래프에 대해서도 적용이 어렵다. ( <em>transductive하다</em> )</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h3 id="2-2-neighborhood-aggregation-gcngraphsagegat">2-2. Neighborhood Aggregation (GCN/GraphSAGE/GAT)</h3>

<p><em>Message Passing</em>으로 이웃 표현을 aggregate해 자신의 표현과 결합하는 연산을 여러 층 반복한다.</p>

<blockquote>

  <p>참고로, <strong>Message Passing</strong>은 “Neural message passing for quantum chemistry.”논문에서 처음 GNN의 framework를 통합적으로 설명하기 위해 제시한 개념으로, 이후 많은 논문들에서 해당 개념을 차용하여 GNN을 설명하기 시작하였다. 
딥마인드의 Petar Veličković는 최신의 ‘beyond message passing’으로 여겨졌던 GNN 기법도 본질적으로 message passing framework으로 모두 설명할 수 있다고  <a href="https://web.stanford.edu/class/cs224w/">“Message passing all the way up” </a> 에서 주장하였다.</p>

</blockquote>

<p>연산은 아래와 같다.</p>

\[\mathbf{h}_i^{(0)}=\mathbf{x}_i,\quad
\mathbf{h}_i^{(k)}=\mathrm{COMBINE}^{(k)}\!\Big(\mathbf{h}_i^{(k-1)},\ \mathrm{AGG}^{(k)}\{\mathbf{h}_j^{(k-1)}:j\in\mathcal{N}(i)\}\Big),\quad
\mathbf{z}_i=\mathbf{h}_i^{(K)}\]

<ul>
  <li>위 encoder 연산의 예는 아래와 같다.
    <ul>
      <li><strong>GCN</strong>에서는 정규화된 연산이 핵심이다.
\(\mathbf{H}^{(\ell+1)}=\sigma\!\big(\hat{D}^{-1/2}\hat{A}\hat{D}^{-1/2}\mathbf{H}^{(\ell)}W^{(\ell)}\big),\qquad \hat{A}=A+I\)
이 식 자체가 “인접하면 가깝다”는 가정을 <strong>encoder의 spectral filter</strong>로 구현한다.</li>
      <li><strong>GraphSAGE</strong>는 aggregator를 선택해 structural bias을 조절한다.
\(\mathbf{h}_i^{(k)}=\sigma\!\Big(W^{(k)}\big[\mathbf{h}_i^{(k-1)}\ \|\ \mathrm{AGG}(\{\mathbf{h}_j^{(k-1)}\}_{j\in\mathcal{N}(i)})\big]\Big)\)</li>
      <li><strong>GAT</strong>는 이웃 중요도를 attention coefficient로 가중한다.</li>
    </ul>
  </li>
  <li><strong>loss function(learning objective)</strong><br />
GNN은 구조 가정을 $\mathrm{ENC}$가 담당하므로, $\mathrm{DEC}$와 손실은 태스크에 맞춰 유연하게 고른다.
    <ul>
      <li>링크 예측 : $\mathrm{DEC}(\mathbf{z}_i,\mathbf{z}_j)=\sigma(\mathbf{z}_i^\top\mathbf{z}_j)$, 네거티브 샘플링</li>
      <li>노드 분류 : $\hat{\mathbf{y}}_i=\mathrm{softmax}(W\mathbf{z}_i)$, cross-enthropy</li>
      <li>그래프/서브그래프 관련 supervised task: $\mathrm{READOUT}$으로 집계 후 태스크별 $\mathrm{DEC}$ 사용</li>
    </ul>
  </li>
</ul>

<p>이 방법은 가장 진보한, 현재에도 활발히 연구되고 있는 graph representation 방식으로, 흔히 GNN을 이야기하면 보통 neighborhood aggregation을 바탕으로 한 이 message passing을 상정한다.</p>

<ul>
  <li><strong>파라미터 공유</strong>로 모델 크기가 그래프 크기와 관계 없이 효율적으로 작게 유지된다.</li>
  <li><strong>노드 feature/edge weight</strong> 등 그래프 관련 meta information을 자연스럽게 활용한다.</li>
  <li><strong>Inductive</strong>한 특징을 가져 새 노드·새 그래프에도 적용이 수월하다.</li>
</ul>

<hr />

<h2 id="마무리하며">마무리하며</h2>

<ul>
  <li>
    <p>그래프 표현 학습의 본질은<br />
<strong>(1) 무엇을 유사로 볼지($s_G$)</strong>, <strong>(2) 임베딩에서 그 유사를 어떻게 읽어낼지($\mathrm{DEC}$)</strong>, <strong>(3) 그 유사를 재현하도록 어떤 연산을 학습할지($\mathrm{ENC}$)</strong>를 일관된 관점에서 설계하는 일이다.</p>

    <ul>
      <li><strong>Shallow</strong>는 “유사도를 정의하고 → 그에 맞춰 임베딩 열을 직접 optimize”한다.</li>
      <li><strong>Neighborhood Autoencoder/SDNE</strong>는 $s_G$의 근사치인 $\mathbf{s}_i$를 정의해 보존하되, 파라미터를 공유하여 더 효율적으로 학습한다</li>
      <li><strong>Neighborhood Aggregation(GNN)</strong>은 “무엇을 보존할지”가 <strong>message passing network</strong>에 녹아 있으며, 태스크에 따라 $\mathrm{DEC}$/손실을 유연하게 붙일 수 있다.</li>
    </ul>
  </li>
</ul>

<p>구체적 방법론과 수식 유도는 후속 글에서 더 다룰 예정이다.</p>

        
      
        <!-- 포스팅 후 광고 넣기 , 출처 : https://shryu8902.github.io/jekyll/adsense/ -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- gpage.taeyoung96 -->
        <div align="center" style="margin: 1em 0;">
          <ins class="adsbygoogle"
              style="display:block"
              data-ad-client="ca-pub-3886880548487088"
              data-ad-slot="7487712129"
              data-ad-format="auto"
              data-full-width-responsive="true"></ins>
        </div>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>

      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#graphs" class="page__taxonomy-item" rel="tag">Graphs</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#representation-learning" class="page__taxonomy-item" rel="tag">Representation learning</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#graphs" class="page__taxonomy-item" rel="tag">Graphs</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2025-08-11">August 11, 2025</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Two+approaches+of+embedding+nodes%20http%3A%2F%2Flocalhost%3A4000%2Fgraphs%2FTwo-approaches-of-embedding-nodes-Shallow-embedding-and-NN-based-embedding%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fgraphs%2FTwo-approaches-of-embedding-nodes-Shallow-embedding-and-NN-based-embedding%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fgraphs%2FTwo-approaches-of-embedding-nodes-Shallow-embedding-and-NN-based-embedding%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/thoughts/08.-%EC%9A%B0%EC%97%B0-%EC%86%8D%EC%9D%98-%ED%95%84%EC%97%B0/" class="pagination--pager" title="우연 속의 필연
">이전</a>
    
    
      <a href="#" class="pagination--pager disabled">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">최근 포스팅 목록</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/thoughts/08.-%EC%9A%B0%EC%97%B0-%EC%86%8D%EC%9D%98-%ED%95%84%EC%97%B0/" rel="permalink">우연 속의 필연
</a>
      
    </h2>
  <!--
    devinlife comments :
        아키이브 싱글 페이지(ex. 카테고리)에 각 포스트 제목 밑에 Updated 시간 표기
        기존에는 read_time이 표기. read_time -> date 변경
    
  -->
  

<p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> August 06 2025</p>

    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/thoughts/07.-%EB%AF%BF%EC%9D%8C%EC%9D%98-%EC%98%81%EC%97%AD/" rel="permalink">믿음의 영역
</a>
      
    </h2>
  <!--
    devinlife comments :
        아키이브 싱글 페이지(ex. 카테고리)에 각 포스트 제목 밑에 Updated 시간 표기
        기존에는 read_time이 표기. read_time -> date 변경
    
  -->
  

<p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> August 03 2025</p>

    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/finance/%ED%88%AC%EC%9E%90%EC%9D%98-%EB%AA%A9%EC%A0%81/" rel="permalink">투자의 목적
</a>
      
    </h2>
  <!--
    devinlife comments :
        아키이브 싱글 페이지(ex. 카테고리)에 각 포스트 제목 밑에 Updated 시간 표기
        기존에는 read_time이 표기. read_time -> date 변경
    
  -->
  

<p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> August 02 2025</p>

    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/finance/%EB%A7%A4%EC%88%98%EB%A7%A4%EB%8F%84%EA%B7%9C%EC%B9%99/" rel="permalink">매수 매도 규칙
</a>
      
    </h2>
  <!--
    devinlife comments :
        아키이브 싱글 페이지(ex. 카테고리)에 각 포스트 제목 밑에 Updated 시간 표기
        기존에는 read_time이 표기. read_time -> date 변경
    
  -->
  

<p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> July 31 2025</p>

    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- gpage.taeyoung96 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3886880548487088"
     data-ad-slot="7487712129"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/darejinn" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 DaRe_jin. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'darejinn/darejinn.github.io');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  




<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      extensions: ["tex2jax.js"],
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
      },
      "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

  </body>
</html>
